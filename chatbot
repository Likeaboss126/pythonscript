import requests

# === CONFIGURE THESE ===
controller = "https://company.saas.appdynamics.com"   # ğŸ‘ˆ replace with your controller domain
token = "eyJ0eXAiOiJKV1QiLCJhbGciOi..."                # ğŸ‘ˆ paste your token here

# === API ENDPOINT ===
url = f"{controller}/controller/rest/applications?output=JSON"

headers = {
    "Authorization": f"Bearer {token}"
}

try:
    print(f"ğŸ” Testing connection to: {url}")
    response = requests.get(url, headers=headers, timeout=30)
    
    if response.status_code == 200:
        print("âœ… Token is valid!")
        print("Response:")
        print(response.text)
    elif response.status_code == 401:
        print("âŒ Unauthorized â€” token might be expired or incorrect.")
    elif response.status_code == 403:
        print("ğŸš« Forbidden â€” your token lacks permission for this endpoint.")
    else:
        print(f"âš ï¸ Unexpected status code: {response.status_code}")
        print(response.text)

except requests.exceptions.SSLError as ssl_err:
    print("âŒ SSL/TLS handshake failed. This usually means:")
    print("   - Your network blocks HTTPS traffic or uses SSL inspection.")
    print("   - The controller certificate is untrusted.")
    print(f"   Details: {ssl_err}")

except requests.exceptions.ConnectionError as conn_err:
    print("âŒ Connection failed. Check controller URL or network access.")
    print(f"   Details: {conn_err}")

except requests.exceptions.Timeout:
    print("â±ï¸ Request timed out â€” network or proxy might be blocking it.")

except Exception as e:
    print(f"âŒ Unexpected error: {e}")

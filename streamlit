def generate_yearly_projection(monthly_sip, annual_return, start_year, end_year):
    r = annual_return / 100
    corpus = 0
    yearly_data = []

    for year in range(start_year, end_year + 1):
        corpus = (corpus + monthly_sip * 12) * (1 + r)
        yearly_data.append({"year": year, "corpus": corpus})

    return yearly_data


import matplotlib.pyplot as plt

def plot_projection_chart(yearly_data, goals, retirement_corpus):
    years = [d["year"] for d in yearly_data]
    corpus_values = [d["corpus"] / 1e7 for d in yearly_data]  # convert to Crores

    plt.figure(figsize=(12, 6))

    # üìà Growth line
    plt.plot(
        years,
        corpus_values,
        linewidth=3,
        label="Corpus Growth"
    )

    # üåà Fill area under curve
    plt.fill_between(years, corpus_values, alpha=0.1)

    # üéØ Goal markers
    for goal in goals:
        goal_year = goal["target_year"]

        for d in yearly_data:
            if d["year"] == goal_year:
                goal_value = d["corpus"] / 1e7
                plt.scatter(goal_year, goal_value, s=80)
                plt.text(
                    goal_year,
                    goal_value,
                    f" {goal['name']}",
                    fontsize=9,
                    verticalalignment="bottom"
                )
                break

    # ‚≠ê Retirement marker
    retirement_value = retirement_corpus / 1e7
    plt.scatter(years[-1], retirement_value, s=120, marker="*")
    plt.text(
        years[-1],
        retirement_value,
        " Retirement",
        fontsize=10,
        fontweight="bold",
        verticalalignment="bottom"
    )

    # üßæ Labels & formatting
    plt.xlabel("Year", fontsize=12)
    plt.ylabel("Corpus (‚Çπ Crores)", fontsize=12)
    plt.title("Wealth Projection Over Time", fontsize=14, fontweight="bold")

    plt.xticks(rotation=45)
    plt.grid(alpha=0.3)

    plt.legend()
    plt.tight_layout()

    return plt



yearly_data = generate_yearly_projection(
    monthly_sip=45000,
    annual_return=9.5,
    start_year=2025,
    end_year=2060
)

goals = [
    {"name": "Child Education", "target_year": 2029},
    {"name": "Vacation", "target_year": 2030}
]

retirement_corpus = yearly_data[-1]["corpus"]

col1.metric("Monthly Investment", "‚Çπ45,000")
col2.metric("Expected CAGR", "9.5%")
col3.metric("Retirement Corpus", f"‚Çπ{retirement_corpus/1e7:.2f} Cr")

fig = plot_projection_chart(yearly_data, goals, retirement_corpus)
st.pyplot(fig)




st.subheader("Retirement Projection Summary")

st.metric("Monthly Investment", "‚Çπ45,000")
st.metric("Expected CAGR", "9.5%")
st.metric("Expected Corpus by 2060", f"‚Çπ{retirement_corpus:,.0f}")



a
